apiVersion: v1
kind: ConfigMap
metadata:
  name: notifications-cm
  namespace: argocd
data:
  notifications.yaml: |
    triggers:
      on-sync-succeeded:
        condition: app.status.sync.status == 'Synced'
        template: send-email
    templates:
      send-email:
        body: |
          Application {{ .app.metadata.name }} has been successfully synced!
        title: Application Sync Notification
        recipients:
          - yoellevy93@gmail.com
        smtp:
          host: smtp.gmail.com
          port: 587
          user: 
            secretRef:
              name: email-secret
              key: smtp-username
          password: 
            secretRef:
              name: email-secret
              key: smtp-password
